<!DOCTYPE html>





<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/echarts.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/echarts.png?v=7.3.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.3.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.3.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"scrollpercent":true,"onmobile":false},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    save_scroll: false,
    copycode: {"enable":true,"show_result":true,"style":null},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    }
  };
</script>

  <meta name="description" content="参考b站教程 一、Docker 介绍1. 安装需要的包12#想安装Docker，需要先将依赖的环境全部下载下来sudo apt install apt-transport-https ca-certificates software-properties-common curl 2. 指定 Docker 镜像源1234#.更换国内软件源，推荐中国科技大学的源，稳定速度快（可选）sudo cp /e">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker">
<meta property="og:url" content="http://yoursite.com/2020/08/01/docker/index.html">
<meta property="og:site_name" content="FILE">
<meta property="og:description" content="参考b站教程 一、Docker 介绍1. 安装需要的包12#想安装Docker，需要先将依赖的环境全部下载下来sudo apt install apt-transport-https ca-certificates software-properties-common curl 2. 指定 Docker 镜像源1234#.更换国内软件源，推荐中国科技大学的源，稳定速度快（可选）sudo cp /e">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-08-07T08:56:23.030Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Docker">
<meta name="twitter:description" content="参考b站教程 一、Docker 介绍1. 安装需要的包12#想安装Docker，需要先将依赖的环境全部下载下来sudo apt install apt-transport-https ca-certificates software-properties-common curl 2. 指定 Docker 镜像源1234#.更换国内软件源，推荐中国科技大学的源，稳定速度快（可选）sudo cp /e">
  <link rel="alternate" href="/atom.xml" title="FILE" type="application/atom+xml">
  <link rel="canonical" href="http://yoursite.com/2020/08/01/docker/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Docker | FILE</title>
  








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  <div class="container sidebar-position-left">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">FILE</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content page-post-detail">
            

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/01/docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Les">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/echarts.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FILE">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">Docker

            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-08-01 09:57:15" itemprop="dateCreated datePublished" datetime="2020-08-01T09:57:15+08:00">2020-08-01</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><a href="https://search.bilibili.com/video?keyword=elastic" target="_blank" rel="noopener">参考b站教程</a></p>
<h2 id="一、Docker-介绍"><a href="#一、Docker-介绍" class="headerlink" title="一、Docker 介绍"></a>一、Docker 介绍</h2><h3 id="1-安装需要的包"><a href="#1-安装需要的包" class="headerlink" title="1. 安装需要的包"></a>1. 安装需要的包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">想安装Docker，需要先将依赖的环境全部下载下来</span></span><br><span class="line">sudo apt install apt-transport-https ca-certificates software-properties-common curl</span><br></pre></td></tr></table></figure>
<h3 id="2-指定-Docker-镜像源"><a href="#2-指定-Docker-镜像源" class="headerlink" title="2. 指定 Docker 镜像源"></a>2. 指定 Docker 镜像源</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">.更换国内软件源，推荐中国科技大学的源，稳定速度快（可选）</span></span><br><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">sudo sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.list</span><br><span class="line">sudo apt update</span><br></pre></td></tr></table></figure>
<h3 id="3-添加-GPG-密钥"><a href="#3-添加-GPG-密钥" class="headerlink" title="3.添加 GPG 密钥"></a>3.添加 GPG 密钥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">添加 Docker-ce 软件源，这里还是以中国科技大学的 Docker-ce 源为例</span></span><br><span class="line">curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">sudo add-apt-repository "deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \</span><br><span class="line"><span class="meta">$</span><span class="bash">(lsb_release -cs) stable<span class="string">"</span></span></span><br></pre></td></tr></table></figure>
<h3 id="3-安装-Docker"><a href="#3-安装-Docker" class="headerlink" title="3. 安装 Docker"></a>3. 安装 Docker</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install docker-ce</span><br></pre></td></tr></table></figure>
<h3 id="4-启动-Docker-并测试"><a href="#4-启动-Docker-并测试" class="headerlink" title="4. 启动 Docker 并测试"></a>4. 启动 Docker 并测试</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">安装成功后，需要手动启动，设置为开机启动，并测试一下 Docker</span><br><span class="line"><span class="meta">#</span><span class="bash">启动docker服务</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="meta">#</span><span class="bash">设置开机自动启动</span></span><br><span class="line">systemctl enable docker</span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>
<h2 id="二、Docker-的中央仓库"><a href="#二、Docker-的中央仓库" class="headerlink" title="二、Docker 的中央仓库"></a>二、Docker 的中央仓库</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1.Docker官方的中央仓库：这个仓库是镜像最全的，但是下载速度较慢。</span><br><span class="line">https://hub.docker.com/</span><br><span class="line">2.国内的镜像网站：网易蜂巢，daoCloud等，下载速度快，但是镜像相对不全。</span><br><span class="line">https://c.163yun.com/hub#/home </span><br><span class="line">http://hub.daocloud.io/ （推荐使用）</span><br><span class="line">3.在公司内部会采用私服的方式拉取镜像（添加配置）</span><br><span class="line"><span class="meta">#</span><span class="bash">需要创建 /etc/docker/daemon.json，并添加如下内容</span></span><br><span class="line">&#123;</span><br><span class="line">	"registry-mirrors":["https://registry.docker-cn.com"],</span><br><span class="line">	"insecure-registries":["ip:port"]</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash">重启两个服务</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>
<h2 id="三、镜像的操作"><a href="#三、镜像的操作" class="headerlink" title="三、镜像的操作"></a>三、镜像的操作</h2><h3 id="1-拉取镜像"><a href="#1-拉取镜像" class="headerlink" title="1. 拉取镜像"></a>1. 拉取镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">从中央仓库拉取镜像到本地</span><br><span class="line">docker pull 镜像名称[:tag]</span><br><span class="line"><span class="meta">#</span><span class="bash">举个栗子:docker pull daocloud.io/library/tomcat:8.5.15-jre8</span></span><br></pre></td></tr></table></figure>
<h3 id="2-查看本地全部镜像"><a href="#2-查看本地全部镜像" class="headerlink" title="2. 查看本地全部镜像"></a>2. 查看本地全部镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看本地已经安装过的镜像信息，包含标识，名称，版本，更新时间，大小</span></span><br><span class="line">docker images</span><br></pre></td></tr></table></figure>
<h3 id="3-删除本地镜像"><a href="#3-删除本地镜像" class="headerlink" title="3. 删除本地镜像"></a>3. 删除本地镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">镜像会占用磁盘空间，可以直接手动删除，标识通过查看获取</span></span><br><span class="line">docker rmi 镜像的标识</span><br></pre></td></tr></table></figure>
<h3 id="4-镜像的导入导出"><a href="#4-镜像的导入导出" class="headerlink" title="4. 镜像的导入导出"></a>4. 镜像的导入导出</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">如果因为网络原因可以通过硬盘的方式传输镜像，虽然不规范，但是有效，但是这种方式导出的镜像名称和版本都是null，需要手动修改</span></span><br><span class="line"><span class="meta">#</span><span class="bash">将本地的镜像导出</span></span><br><span class="line">docker save -o 导出的路径 镜像id</span><br><span class="line"><span class="meta">#</span><span class="bash">加载本地的镜像文件</span></span><br><span class="line">docker load -i 镜像文件</span><br><span class="line"><span class="meta">#</span><span class="bash">修改镜像文件</span></span><br><span class="line">docker tag 镜像id 新镜像名称：版本</span><br></pre></td></tr></table></figure>
<h2 id="四、容器的操作"><a href="#四、容器的操作" class="headerlink" title="四、容器的操作"></a>四、容器的操作</h2><h3 id="1-运行容器"><a href="#1-运行容器" class="headerlink" title="1. 运行容器"></a>1. 运行容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">运行容器需要定制具体镜像，如果镜像不存在，会直接下载</span><br><span class="line"><span class="meta">#</span><span class="bash">简单操作</span></span><br><span class="line">docker run 镜像的标识|镜像的名称[:tag]</span><br><span class="line"><span class="meta">#</span><span class="bash">常用的参数</span></span><br><span class="line">docker run -d -p 宿主机端口:容器端口 --name 容器名称 镜像的标识|镜像名称[:tag]</span><br><span class="line"><span class="meta">#</span><span class="bash">-d:代表后台运行容器</span></span><br><span class="line"><span class="meta">#</span><span class="bash">-p 宿主机端口:容器端口：为了映射当前Linux的端口和容器的端口</span></span><br><span class="line"><span class="meta">#</span><span class="bash">--name 容器名称:指定容器的名称</span></span><br></pre></td></tr></table></figure>
<h3 id="2-查看正在运行的容器"><a href="#2-查看正在运行的容器" class="headerlink" title="2. 查看正在运行的容器"></a>2. 查看正在运行的容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">查看全部正在运行的容器信息</span><br><span class="line">docker ps [-qa]</span><br><span class="line"><span class="meta">#</span><span class="bash">-a 查看全部的容器，包括没有运行</span></span><br><span class="line"><span class="meta">#</span><span class="bash">-q 只查看容器的标识</span></span><br></pre></td></tr></table></figure>
<h3 id="3-查看容器日志"><a href="#3-查看容器日志" class="headerlink" title="3. 查看容器日志"></a>3. 查看容器日志</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">查看容器日志，以查看容器运行的信息</span><br><span class="line">docker logs -f 容器id</span><br><span class="line"><span class="meta">#</span><span class="bash">-f：可以滚动查看日志的最后几行</span></span><br></pre></td></tr></table></figure>
<h3 id="4-进入容器的内部"><a href="#4-进入容器的内部" class="headerlink" title="4. 进入容器的内部"></a>4. 进入容器的内部</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可以进入容器的内部进行操作</span><br><span class="line">docker exec -it 容器id bash</span><br></pre></td></tr></table></figure>
<h3 id="5-复制内容到容器"><a href="#5-复制内容到容器" class="headerlink" title="5. 复制内容到容器"></a>5. 复制内容到容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">将宿主机的文件复制到容器内部的指定目录</span><br><span class="line">docker cp 文件名称 容器id:容器内部路径</span><br></pre></td></tr></table></figure>
<h3 id="6-重启-amp-启动-amp-停止-amp-删除容器"><a href="#6-重启-amp-启动-amp-停止-amp-删除容器" class="headerlink" title="6. 重启 &amp; 启动 &amp; 停止 &amp; 删除容器"></a>6. 重启 &amp; 启动 &amp; 停止 &amp; 删除容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">容器的启动，停止，删除等操作，后续会经常使用到</span><br><span class="line"><span class="meta">#</span><span class="bash">重新启动容器</span></span><br><span class="line">docker restart 容器id</span><br><span class="line"><span class="meta">#</span><span class="bash">启动停止运行的容器</span></span><br><span class="line">docker start 容器id</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">停止指定的容器(删除容器前，需要先停止容器)</span></span><br><span class="line">docker stop 容器id</span><br><span class="line"><span class="meta">#</span><span class="bash">停止全部容器</span></span><br><span class="line">docker stop $(docker ps -qa)</span><br><span class="line"><span class="meta">#</span><span class="bash">删除指定容器</span></span><br><span class="line">docker rm 容器id</span><br><span class="line"><span class="meta">#</span><span class="bash">删除全部容器</span></span><br><span class="line">docker rm $(docker ps -qa)</span><br></pre></td></tr></table></figure>
<h2 id="五、Docker-应用"><a href="#五、Docker-应用" class="headerlink" title="五、Docker 应用"></a>五、Docker 应用</h2><h3 id="1-docker-安装-tomcat"><a href="#1-docker-安装-tomcat" class="headerlink" title="1.docker 安装 tomcat"></a>1.docker 安装 tomcat</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">运行Tomcat容器，为部署ssm工程做准备</span><br><span class="line"> </span><br><span class="line">docker run -d -p 8080:8080 --name tomcat  daocloud.io/library/tomcat:8.5.15-jre8</span><br><span class="line"><span class="meta">#</span><span class="bash">或者已经下载了tomcat镜像</span></span><br><span class="line">docker run -d -p 8080:8080 --name tomcat 镜像的标识</span><br></pre></td></tr></table></figure>
<h3 id="2-运行-MySQL-容器"><a href="#2-运行-MySQL-容器" class="headerlink" title="2. 运行 MySQL 容器"></a>2. 运行 MySQL 容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=root daocloud.io/library/mysql:5.7.4</span><br></pre></td></tr></table></figure>
<h3 id="3-部署-ssm-工程"><a href="#3-部署-ssm-工程" class="headerlink" title="3. 部署 ssm 工程"></a>3. 部署 ssm 工程</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">修改SSM工程环境，设置为Linux中Docker容器的信息</span><br><span class="line">通过Maven的package重新打成war包</span><br><span class="line">将Windows下的war包复制到Linux中</span><br><span class="line">通过docker命令将宿主机的war包复制到容器内部</span><br><span class="line">docker cp 文件名称 容器id:容器内部路径</span><br><span class="line">测试访问SSM工程</span><br></pre></td></tr></table></figure>
<h3 id="六、数据卷"><a href="#六、数据卷" class="headerlink" title="六、数据卷"></a>六、数据卷</h3><p>为了部署 SSM 的工程，需要使用到 cp 的命令将宿主机内的 ssm.war 文件复制到容器内部。</p>
<p>数据卷：将宿主机的一个目录映射到容器的一个目录中。</p>
<p>可以在宿主机中操作目录中的内容，那么容器内部映射的文件，也会跟着一起改变。  </p>
<h3 id="1-创建数据卷"><a href="#1-创建数据卷" class="headerlink" title="1. 创建数据卷"></a>1. 创建数据卷</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">创建数据卷后，默认会存放在一个目录下/var/lib/docker/volumes/数据卷名称/_data</span></span><br><span class="line">docker volume create 数据卷名称</span><br></pre></td></tr></table></figure>
<h3 id="2-查看全部数据卷"><a href="#2-查看全部数据卷" class="headerlink" title="2. 查看全部数据卷"></a>2. 查看全部数据卷</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看全部数据卷信息</span></span><br><span class="line">docker volume ls</span><br></pre></td></tr></table></figure>
<h3 id="3-查看数据卷详情"><a href="#3-查看数据卷详情" class="headerlink" title="3. 查看数据卷详情"></a>3. 查看数据卷详情</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看数据卷的详细信息，可以查询到存放的路径，创建时间等等</span></span><br><span class="line">docker volume inspect 数据卷名称</span><br></pre></td></tr></table></figure>
<h3 id="4-删除数据卷"><a href="#4-删除数据卷" class="headerlink" title="4. 删除数据卷"></a>4. 删除数据卷</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除指定的数据卷</span></span><br><span class="line">docker volume rm 数据卷名称</span><br></pre></td></tr></table></figure>
<h3 id="5-容器映射数据卷"><a href="#5-容器映射数据卷" class="headerlink" title="5. 容器映射数据卷"></a>5. 容器映射数据卷</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#通过数据卷名称映射，如果数据卷不存在。Docker会帮你自动创建，会将容器内部自带的文件，存储在默认的存放路径中。</span></span><br><span class="line">docker run -d -p 8080:8080 --name tomcat -v 数据卷名称:容器内部的路径 镜像id</span><br><span class="line"> </span><br><span class="line"><span class="comment">#通过路径映射数据卷，直接指定一个路径作为数据卷的存放位置。但是这个路径下是空的。</span></span><br><span class="line">docker run -d -p 8080:8080 --name tomcat -v 路径(/root/自己创建的文件夹):容器内部的路径 镜像id</span><br></pre></td></tr></table></figure>
<h2 id="七、Dockerfile-自定义镜像"><a href="#七、Dockerfile-自定义镜像" class="headerlink" title="七、Dockerfile 自定义镜像"></a>七、Dockerfile 自定义镜像</h2><h3 id="1-Dockerfile"><a href="#1-Dockerfile" class="headerlink" title="1.Dockerfile"></a>1.Dockerfile</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">创建自定义镜像就需要创建一个Dockerfiler,如下为Dockerfile的语言</span><br><span class="line"> </span><br><span class="line">from：指定当前自定义镜像依赖的环境</span><br><span class="line">copy：将相对路径下的内容复制到自定义镜像中</span><br><span class="line">workdir：声明镜像的默认工作目录</span><br><span class="line">run：执行的命令，可以编写多个</span><br><span class="line">cmd：需要执行的命令（在workdir下执行的，cmd可以写多个，只以最后一个为准）</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">示例：</span></span><br><span class="line">from daocloud.io/library/tomcat:8.5.15-jre8</span><br><span class="line">copy ssm.war /usr/local/tomcat/webapps</span><br></pre></td></tr></table></figure>
<h3 id="2-通过-Dockerfile-制作镜像"><a href="#2-通过-Dockerfile-制作镜像" class="headerlink" title="2. 通过 Dockerfile 制作镜像"></a>2. 通过 Dockerfile 制作镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">编写完Dockerfile后需要通过命令将其制作为镜像，并且要在Dockerfile的当前目录下，之后即可在镜像中查看到指定的镜像信息，注意最后的 .</span></span><br><span class="line">docker build -t 镜像名称[:tag] ./</span><br></pre></td></tr></table></figure>
<h2 id="八、Docker-Compose"><a href="#八、Docker-Compose" class="headerlink" title="八、Docker-Compose"></a>八、Docker-Compose</h2><h3 id="1-下载并安装-Docker-Compose"><a href="#1-下载并安装-Docker-Compose" class="headerlink" title="1. 下载并安装 Docker-Compose"></a>1. 下载并安装 Docker-Compose</h3><h3 id="1-1-下载-Docker-Compose"><a href="#1-1-下载-Docker-Compose" class="headerlink" title="1.1 下载 Docker-Compose"></a>1.1 下载 Docker-Compose</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">去github官网搜索docker-compose，下载1.24.1版本的Docker-Compose</span></span><br><span class="line">下载路径：https://github.com/docker/compose/releases/download/1.24.1/docker-compose-Linux-x86_64</span><br></pre></td></tr></table></figure>
<h3 id="1-2-设置权限"><a href="#1-2-设置权限" class="headerlink" title="1.2 设置权限"></a>1.2 设置权限</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#需要将DockerCompose文件的名称修改一下，给予DockerCompose文件一个可执行的权限</span><br><span class="line">mv docker-compose-Linux-x86_64 docker-compose</span><br><span class="line">chmod 777 docker-compose</span><br></pre></td></tr></table></figure>
<h3 id="1-3-配置环境变量"><a href="#1-3-配置环境变量" class="headerlink" title="1.3 配置环境变量"></a>1.3 配置环境变量</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">方便后期操作，配置一个环境变量</span></span><br><span class="line"><span class="meta">#</span><span class="bash">将docker-compose文件移动到了/usr/<span class="built_in">local</span>/bin，修改了/etc/profile文件，给/usr/<span class="built_in">local</span>/bin配置到了PATH中</span></span><br><span class="line"> </span><br><span class="line">mv docker-compose /usr/local/bin</span><br><span class="line">vi /etc/profile</span><br><span class="line"><span class="meta">#</span><span class="bash">添加内容：<span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>:/usr/<span class="built_in">local</span>/bin:<span class="variable">$PATH</span></span></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
<h3 id="1-4-测试"><a href="#1-4-测试" class="headerlink" title="1.4 测试"></a>1.4 测试</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在任意目录下输入docker-compose</span><br></pre></td></tr></table></figure>
<h3 id="2-Docker-Compose-管理-MySQL-和-Tomcat-容器"><a href="#2-Docker-Compose-管理-MySQL-和-Tomcat-容器" class="headerlink" title="2.Docker-Compose 管理 MySQL 和 Tomcat 容器"></a>2.Docker-Compose 管理 MySQL 和 Tomcat 容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">yml文件以key:value方式来指定配置信息</span><br><span class="line">多个配置信息以换行+缩进的方式来区分</span><br><span class="line">在docker-compose.yml文件中，不要使用制表符</span><br><span class="line"> </span><br><span class="line">version: '3.1'</span><br><span class="line">services:</span><br><span class="line">  mysql:           # 服务的名称</span><br><span class="line">    restart: always   # 代表只要docker启动，那么这个容器就跟着一起启动</span><br><span class="line">    image: daocloud.io/library/mysql:5.7.4  # 指定镜像路径</span><br><span class="line">    container_name: mysql  # 指定容器名称</span><br><span class="line">    ports:</span><br><span class="line">      - 3306:3306   #  指定端口号的映射</span><br><span class="line">    environment:</span><br><span class="line">      MYSQL_ROOT_PASSWORD: root   # 指定MySQL的ROOT用户登录密码</span><br><span class="line">      TZ: Asia/Shanghai        # 指定时区</span><br><span class="line">    volumes:</span><br><span class="line">     - /opt/docker_mysql_tomcat/mysql_data:/var/lib/mysql   # 映射数据卷</span><br><span class="line">  tomcat:</span><br><span class="line">    restart: always</span><br><span class="line">    image: daocloud.io/library/tomcat:8.5.15-jre8</span><br><span class="line">    container_name: tomcat</span><br><span class="line">    ports:</span><br><span class="line">      - 8080:8080</span><br><span class="line">    environment:</span><br><span class="line">      TZ: Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - /opt/docker_mysql_tomcat/tomcat_webapps:/usr/local/tomcat/webapps</span><br><span class="line">      - /opt/docker_mysql_tomcat/tomcat_logs:/usr/local/tomcat/logs</span><br></pre></td></tr></table></figure>
<h3 id="3-使用-docker-compose-命令管理容器"><a href="#3-使用-docker-compose-命令管理容器" class="headerlink" title="3. 使用 docker-compose 命令管理容器"></a>3. 使用 docker-compose 命令管理容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">在使用docker-compose的命令时，默认会在当前目录下找docker-compose.yml文件</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">1.基于docker-compose.yml启动管理的容器</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">2.关闭并删除容器</span></span><br><span class="line">docker-compose down</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">3.开启|关闭|重启已经存在的由docker-compose维护的容器</span></span><br><span class="line">docker-compose start|stop|restart</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">4.查看由docker-compose管理的容器</span></span><br><span class="line">docker-compose ps</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">5.查看日志</span></span><br><span class="line">docker-compose logs -f</span><br></pre></td></tr></table></figure>
<h3 id="4-docker-compose-配合-Dockerfile-使用"><a href="#4-docker-compose-配合-Dockerfile-使用" class="headerlink" title="4.docker-compose 配合 Dockerfile 使用"></a>4.docker-compose 配合 Dockerfile 使用</h3><p>使用 docker-compose.yml 文件以及 Dockerfile 文件在生成自定义镜像的同时启动当前镜像，并且由 docker-compose 去管理容器  </p>
<h3 id="4-1docker-compose-文件"><a href="#4-1docker-compose-文件" class="headerlink" title="4.1docker-compose 文件"></a>4.1docker-compose 文件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">编写docker-compose文件</span><br><span class="line"> </span><br><span class="line"><span class="comment"># yml文件</span></span><br><span class="line">version: <span class="string">'3.1'</span></span><br><span class="line">services:</span><br><span class="line">  ssm:</span><br><span class="line">    restart: always</span><br><span class="line">    build:            <span class="comment"># 构建自定义镜像</span></span><br><span class="line">      context: ../      <span class="comment"># 指定dockerfile文件的所在路径</span></span><br><span class="line">      dockerfile: Dockerfile   <span class="comment"># 指定Dockerfile文件名称</span></span><br><span class="line">    image: ssm:1.0.1</span><br><span class="line">    container_name: ssm</span><br><span class="line">    ports:</span><br><span class="line">      - 8081:8080</span><br><span class="line">    environment:</span><br><span class="line">      TZ: Asia/Shanghai</span><br></pre></td></tr></table></figure>
<h3 id="4-2-Dockerfile-文件"><a href="#4-2-Dockerfile-文件" class="headerlink" title="4.2 Dockerfile 文件"></a>4.2 Dockerfile 文件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">编写Dockerfile文件</span><br><span class="line"> </span><br><span class="line">from daocloud.io/library/tomcat:8.5.15-jre8</span><br><span class="line">copy ssm.war /usr/<span class="built_in">local</span>/tomcat/webapps</span><br></pre></td></tr></table></figure>
<h3 id="4-3-运行"><a href="#4-3-运行" class="headerlink" title="4.3 运行"></a>4.3 运行</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可以直接基于docker-compose.yml以及Dockerfile文件构建的自定义镜像</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"><span class="comment"># 如果自定义镜像不存在，会帮助我们构建出自定义镜像，如果自定义镜像已经存在，会直接运行这个自定义镜像</span></span><br><span class="line"><span class="comment">#重新构建自定义镜像</span></span><br><span class="line">docker-compose build</span><br><span class="line"><span class="comment">#运行当前内容，并重新构建</span></span><br><span class="line">docker-compose up -d --build</span><br></pre></td></tr></table></figure>
<h2 id="九、CI、CD-介绍及准备"><a href="#九、CI、CD-介绍及准备" class="headerlink" title="九、CI、CD 介绍及准备"></a>九、CI、CD 介绍及准备</h2><h3 id="1-CI、CD-引言"><a href="#1-CI、CD-引言" class="headerlink" title="1.CI、CD 引言"></a>1.CI、CD 引言</h3><p>项目部署  </p>
<ol>
<li>将项目通过 maven 进行编译打包  </li>
<li>将文件上传到指定的服务器中  </li>
<li>将 war 包放到 tomcat 的目录中  </li>
<li>通过 Dockerfile 将 Tomcat 和 war 包转成一个镜像，由 DockerCompose 去运行容器<br>项目更新后，需要将上述流程再次的从头到尾的执行一次，如果每次更新一次都执行一次上述操作，很费时，费力。我们就可以通过 CI、CD 帮助我们实现持续集成，持续交付和部署  </li>
</ol>
<h3 id="2-CI-介绍"><a href="#2-CI-介绍" class="headerlink" title="2.CI 介绍"></a>2.CI 介绍</h3><p>CI（continuous intergration）持续集成<br>持续集成：编写代码时，完成了一个功能后，立即提交代码到 Git 仓库中，将项目重新的构建并且测试。</p>
<ol>
<li>快速发现错误。  </li>
<li>防止代码偏离主分支。  </li>
</ol>
<h3 id="3-搭建-Gitlab-服务器"><a href="#3-搭建-Gitlab-服务器" class="headerlink" title="3. 搭建 Gitlab 服务器"></a>3. 搭建 Gitlab 服务器</h3><h3 id="3-1-准备环境"><a href="#3-1-准备环境" class="headerlink" title="3.1. 准备环境"></a>3.1. 准备环境</h3><p>实现 CI，需要使用到 Gitlab 远程仓库，先通过 Docker 搭建 Gitlab<br>创建一个全新的虚拟机，并且至少指定 4G 的运行内存，4G 运行内存是 Gitlab 推荐的内存大小。<br>并且安装 Docker 以及 Docker-Compose  </p>
<h3 id="3-2-修改-ssh-的-22-端口"><a href="#3-2-修改-ssh-的-22-端口" class="headerlink" title="3.2 修改 ssh 的 22 端口"></a>3.2 修改 ssh 的 22 端口</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将ssh的默认22端口，修改为60022端口，因为Gitlab需要占用22端口</span></span><br><span class="line"> </span><br><span class="line">vi /etc/ssh/sshd_config</span><br><span class="line">  PORT 22 -&gt; 60022</span><br><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure>
<h3 id="3-3-编写-docker-compose-yml"><a href="#3-3-编写-docker-compose-yml" class="headerlink" title="3.3 编写 docker-compose.yml"></a>3.3 编写 docker-compose.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">docker-compose.yml文件去安装gitlab（下载和运行的时间比较长的）</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">version:</span> <span class="string">'3.1'</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"> <span class="attr">gitlab:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">'twang2218/gitlab-ce-zh:11.1.4'</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">"gitlab"</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hostname:</span> <span class="string">'gitlab'</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">   <span class="attr">TZ:</span> <span class="string">'Asia/Shanghai'</span></span><br><span class="line">   <span class="attr">GITLAB_OMNIBUS_CONFIG:</span> <span class="string">|</span></span><br><span class="line">    <span class="string">external_url</span> <span class="string">'http://xxx.xxx.xxx.xxx'</span></span><br><span class="line">    <span class="string">gitlab_rails['time_zone']</span> <span class="string">=</span> <span class="string">'Asia/Shanghai'</span></span><br><span class="line">    <span class="string">gitlab_rails['smtp_enable']</span> <span class="string">=</span> <span class="literal">true</span></span><br><span class="line">    <span class="string">gitlab_rails['gitlab_shell_ssh_port']</span> <span class="string">=</span> <span class="number">22</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">'80:80'</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">'443:443'</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">'22:22'</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">/opt/docker_gitlab/config:/etc/gitlab</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">/opt/docker_gitlab/data:/var/opt/gitlab</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">/opt/docker_gitlab/logs:/var/log/gitlab</span></span><br></pre></td></tr></table></figure>
<h2 id="十、搭建-GitlabRunner"><a href="#十、搭建-GitlabRunner" class="headerlink" title="十、搭建 GitlabRunner"></a>十、搭建 GitlabRunner</h2><h3 id="1-准备文件"><a href="#1-准备文件" class="headerlink" title="1. 准备文件"></a>1. 准备文件</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">daemon.json</span><br><span class="line"> </span><br><span class="line">&#123;</span><br><span class="line">“registry-mirrors”: [“https://registry.docker-cn.com”],</span><br><span class="line">“insecure-registries”: [ip:ports]</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">文件夹 environment里面准备maven安装包，jdk1.8安装包，Dockerfile，daemon.json以及docker-compose</span><br></pre></td></tr></table></figure>
<h3 id="2-开始搭建"><a href="#2-开始搭建" class="headerlink" title="2. 开始搭建"></a>2. 开始搭建</h3><p>创建工作目录 /usr/local/docker_gitlab-runner<br>将 docker-compose.yml 文件以及 environment 目录全部复制到上述目录中<br>在宿主机启动 docker 程序后先执行 sudo chown root:root /var/run/docker.sock (如果重启过 docker, 重新执行)<br>在 / usr/local/docker_gitlab-runner 目录中执行 docker-compose up -d –build 启动容器<br>添加容器权限，保证容器可以使用宿主机的 dockerdocker exec -it gitlab-runner usermod -aG root gitlab-runner<br>注册 Runner 信息到 gitlab  </p>
<h3 id="3-进入后续步骤"><a href="#3-进入后续步骤" class="headerlink" title="3. 进入后续步骤"></a>3. 进入后续步骤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it gitlab-runner gitlab-runner register</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 输入 GitLab 地址</span></span><br><span class="line">Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com/):</span><br><span class="line">http://192.168.199.109/</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 输入 GitLab Token</span></span><br><span class="line">Please enter the gitlab-ci token for this runner:</span><br><span class="line">1Lxq_f1NRfCfeNbE5WRh</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 输入 Runner 的说明</span></span><br><span class="line">Please enter the gitlab-ci description for this runner:</span><br><span class="line">可以为空</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置 Tag，可以用于指定在构建规定的 tag 时触发 ci</span></span><br><span class="line">Please enter the gitlab-ci tags for this runner (comma separated):</span><br><span class="line">deploy</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里选择 <span class="literal">true</span> ，可以用于代码上传后直接执行（根据版本，也会没有次选项）</span></span><br><span class="line">Whether to run untagged builds [true/false]:</span><br><span class="line">true</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里选择 <span class="literal">false</span>，可以直接回车，默认为 <span class="literal">false</span>（根据版本，也会没有次选项）</span></span><br><span class="line">Whether to lock Runner to current project [true/false]:</span><br><span class="line">false</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 选择 runner 执行器，这里我们选择的是 shell</span></span><br><span class="line">Please enter the executor: virtualbox, docker+machine, parallels, shell, ssh, docker-ssh+machine, kubernetes, docker, docker-ssh:</span><br><span class="line">shell</span><br></pre></td></tr></table></figure>
<h2 id="十一、整合项目入门测试"><a href="#十一、整合项目入门测试" class="headerlink" title="十一、整合项目入门测试"></a>十一、整合项目入门测试</h2><h3 id="1-创建项目"><a href="#1-创建项目" class="headerlink" title="1. 创建项目"></a>1. 创建项目</h3><p>创建 maven 工程，添加 web.xml 文件，编写 HTML 页面  </p>
<h3 id="2-编写-gitlab-ci-yml-文件"><a href="#2-编写-gitlab-ci-yml-文件" class="headerlink" title="2. 编写. gitlab-ci.yml 文件"></a>2. 编写. gitlab-ci.yml 文件</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">test</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">first</span> <span class="string">test</span> <span class="string">ci</span>   <span class="comment"># 输入的命令</span></span><br></pre></td></tr></table></figure>
<h3 id="3-将-maven-工程推送到-gitlab-中"><a href="#3-将-maven-工程推送到-gitlab-中" class="headerlink" title="3. 将 maven 工程推送到 gitlab 中"></a>3. 将 maven 工程推送到 gitlab 中</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">执行git命令推送到Gitlab</span><br><span class="line"> </span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
<h3 id="4-查看效果"><a href="#4-查看效果" class="headerlink" title="4. 查看效果"></a>4. 查看效果</h3><p>可以在 gitlab 中查看到 gitlab-ci.yml 编写的内容  </p>
<h2 id="十二、完善项目配置"><a href="#十二、完善项目配置" class="headerlink" title="十二、完善项目配置"></a>十二、完善项目配置</h2><p>添加 Dockerfile 以及 docker-compose.yml， 并修改. gitlab-ci.yml 文件  </p>
<h3 id="1-创建-Dockerfile"><a href="#1-创建-Dockerfile" class="headerlink" title="1. 创建 Dockerfile"></a>1. 创建 Dockerfile</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Dockerfile</span></span><br><span class="line">FROM daocloud.io/library/tomcat:8.5.15-jre8</span><br><span class="line">COPY testci.war /usr/local/tomcat/webapps</span><br></pre></td></tr></table></figure>
<h3 id="2-创建-docker-compose-yml"><a href="#2-创建-docker-compose-yml" class="headerlink" title="2. 创建 docker-compose.yml"></a>2. 创建 docker-compose.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker-compose.yml</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">"3.1"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">testci:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">docker</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">testci</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:8080</span></span><br></pre></td></tr></table></figure>
<h3 id="3-修改-gitlab-ci-yml"><a href="#3-修改-gitlab-ci-yml" class="headerlink" title="3. 修改. gitlab-ci.yml"></a>3. 修改. gitlab-ci.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ci.yml</span></span><br><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">test</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">first</span> <span class="string">test</span> <span class="string">ci</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/usr/local/maven/apache-maven-3.6.3/bin/mvn</span> <span class="string">package</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">cp</span> <span class="string">target/testci-1.0-SNAPSHOT.war</span> <span class="string">docker/testci.war</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker-compose</span> <span class="string">down</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker-compose</span> <span class="string">up</span> <span class="string">-d</span> <span class="string">--build</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">rmi</span> <span class="string">$(docker</span> <span class="string">images</span> <span class="string">-qf</span> <span class="string">dangling=true)</span></span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        
      

      <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/07/12/ES/" rel="next" title="ElasticSearch">
                  <i class="fa fa-chevron-left"></i> ElasticSearch
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2020/08/07/document_embedding/" rel="prev" title="Document_Embedding">
                  Document_Embedding <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/echarts.png"
      alt="Les">
  <p class="site-author-name" itemprop="name">Les</p>
  <div class="site-description motion-element" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">129</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">categories</span>
        
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span>
        
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



        </div>
      </div>
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、Docker-介绍"><span class="nav-number">1.</span> <span class="nav-text">一、Docker 介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-安装需要的包"><span class="nav-number">1.1.</span> <span class="nav-text">1. 安装需要的包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-指定-Docker-镜像源"><span class="nav-number">1.2.</span> <span class="nav-text">2. 指定 Docker 镜像源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-添加-GPG-密钥"><span class="nav-number">1.3.</span> <span class="nav-text">3.添加 GPG 密钥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-安装-Docker"><span class="nav-number">1.4.</span> <span class="nav-text">3. 安装 Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-启动-Docker-并测试"><span class="nav-number">1.5.</span> <span class="nav-text">4. 启动 Docker 并测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、Docker-的中央仓库"><span class="nav-number">2.</span> <span class="nav-text">二、Docker 的中央仓库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、镜像的操作"><span class="nav-number">3.</span> <span class="nav-text">三、镜像的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-拉取镜像"><span class="nav-number">3.1.</span> <span class="nav-text">1. 拉取镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-查看本地全部镜像"><span class="nav-number">3.2.</span> <span class="nav-text">2. 查看本地全部镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-删除本地镜像"><span class="nav-number">3.3.</span> <span class="nav-text">3. 删除本地镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-镜像的导入导出"><span class="nav-number">3.4.</span> <span class="nav-text">4. 镜像的导入导出</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、容器的操作"><span class="nav-number">4.</span> <span class="nav-text">四、容器的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-运行容器"><span class="nav-number">4.1.</span> <span class="nav-text">1. 运行容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-查看正在运行的容器"><span class="nav-number">4.2.</span> <span class="nav-text">2. 查看正在运行的容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-查看容器日志"><span class="nav-number">4.3.</span> <span class="nav-text">3. 查看容器日志</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-进入容器的内部"><span class="nav-number">4.4.</span> <span class="nav-text">4. 进入容器的内部</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-复制内容到容器"><span class="nav-number">4.5.</span> <span class="nav-text">5. 复制内容到容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-重启-amp-启动-amp-停止-amp-删除容器"><span class="nav-number">4.6.</span> <span class="nav-text">6. 重启 &amp; 启动 &amp; 停止 &amp; 删除容器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、Docker-应用"><span class="nav-number">5.</span> <span class="nav-text">五、Docker 应用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-docker-安装-tomcat"><span class="nav-number">5.1.</span> <span class="nav-text">1.docker 安装 tomcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-运行-MySQL-容器"><span class="nav-number">5.2.</span> <span class="nav-text">2. 运行 MySQL 容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-部署-ssm-工程"><span class="nav-number">5.3.</span> <span class="nav-text">3. 部署 ssm 工程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#六、数据卷"><span class="nav-number">5.4.</span> <span class="nav-text">六、数据卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-创建数据卷"><span class="nav-number">5.5.</span> <span class="nav-text">1. 创建数据卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-查看全部数据卷"><span class="nav-number">5.6.</span> <span class="nav-text">2. 查看全部数据卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-查看数据卷详情"><span class="nav-number">5.7.</span> <span class="nav-text">3. 查看数据卷详情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-删除数据卷"><span class="nav-number">5.8.</span> <span class="nav-text">4. 删除数据卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-容器映射数据卷"><span class="nav-number">5.9.</span> <span class="nav-text">5. 容器映射数据卷</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#七、Dockerfile-自定义镜像"><span class="nav-number">6.</span> <span class="nav-text">七、Dockerfile 自定义镜像</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Dockerfile"><span class="nav-number">6.1.</span> <span class="nav-text">1.Dockerfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-通过-Dockerfile-制作镜像"><span class="nav-number">6.2.</span> <span class="nav-text">2. 通过 Dockerfile 制作镜像</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#八、Docker-Compose"><span class="nav-number">7.</span> <span class="nav-text">八、Docker-Compose</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-下载并安装-Docker-Compose"><span class="nav-number">7.1.</span> <span class="nav-text">1. 下载并安装 Docker-Compose</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-下载-Docker-Compose"><span class="nav-number">7.2.</span> <span class="nav-text">1.1 下载 Docker-Compose</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-设置权限"><span class="nav-number">7.3.</span> <span class="nav-text">1.2 设置权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-配置环境变量"><span class="nav-number">7.4.</span> <span class="nav-text">1.3 配置环境变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-测试"><span class="nav-number">7.5.</span> <span class="nav-text">1.4 测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Docker-Compose-管理-MySQL-和-Tomcat-容器"><span class="nav-number">7.6.</span> <span class="nav-text">2.Docker-Compose 管理 MySQL 和 Tomcat 容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-使用-docker-compose-命令管理容器"><span class="nav-number">7.7.</span> <span class="nav-text">3. 使用 docker-compose 命令管理容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-docker-compose-配合-Dockerfile-使用"><span class="nav-number">7.8.</span> <span class="nav-text">4.docker-compose 配合 Dockerfile 使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1docker-compose-文件"><span class="nav-number">7.9.</span> <span class="nav-text">4.1docker-compose 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-Dockerfile-文件"><span class="nav-number">7.10.</span> <span class="nav-text">4.2 Dockerfile 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-运行"><span class="nav-number">7.11.</span> <span class="nav-text">4.3 运行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#九、CI、CD-介绍及准备"><span class="nav-number">8.</span> <span class="nav-text">九、CI、CD 介绍及准备</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-CI、CD-引言"><span class="nav-number">8.1.</span> <span class="nav-text">1.CI、CD 引言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-CI-介绍"><span class="nav-number">8.2.</span> <span class="nav-text">2.CI 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-搭建-Gitlab-服务器"><span class="nav-number">8.3.</span> <span class="nav-text">3. 搭建 Gitlab 服务器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-准备环境"><span class="nav-number">8.4.</span> <span class="nav-text">3.1. 准备环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-修改-ssh-的-22-端口"><span class="nav-number">8.5.</span> <span class="nav-text">3.2 修改 ssh 的 22 端口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-编写-docker-compose-yml"><span class="nav-number">8.6.</span> <span class="nav-text">3.3 编写 docker-compose.yml</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十、搭建-GitlabRunner"><span class="nav-number">9.</span> <span class="nav-text">十、搭建 GitlabRunner</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-准备文件"><span class="nav-number">9.1.</span> <span class="nav-text">1. 准备文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-开始搭建"><span class="nav-number">9.2.</span> <span class="nav-text">2. 开始搭建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-进入后续步骤"><span class="nav-number">9.3.</span> <span class="nav-text">3. 进入后续步骤</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十一、整合项目入门测试"><span class="nav-number">10.</span> <span class="nav-text">十一、整合项目入门测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-创建项目"><span class="nav-number">10.1.</span> <span class="nav-text">1. 创建项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-编写-gitlab-ci-yml-文件"><span class="nav-number">10.2.</span> <span class="nav-text">2. 编写. gitlab-ci.yml 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-将-maven-工程推送到-gitlab-中"><span class="nav-number">10.3.</span> <span class="nav-text">3. 将 maven 工程推送到 gitlab 中</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-查看效果"><span class="nav-number">10.4.</span> <span class="nav-text">4. 查看效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十二、完善项目配置"><span class="nav-number">11.</span> <span class="nav-text">十二、完善项目配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-创建-Dockerfile"><span class="nav-number">11.1.</span> <span class="nav-text">1. 创建 Dockerfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-创建-docker-compose-yml"><span class="nav-number">11.2.</span> <span class="nav-text">2. 创建 docker-compose.yml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-修改-gitlab-ci-yml"><span class="nav-number">11.3.</span> <span class="nav-text">3. 修改. gitlab-ci.yml</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Les</span>
</div>

        








        
      </div>
    </footer>
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
      </div>

    

  </div>

  
    
    
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

<script src="/js/utils.js?v=7.3.0"></script>
  <script src="/js/motion.js?v=7.3.0"></script>


  <script src="/js/affix.js?v=7.3.0"></script>
  <script src="/js/schemes/pisces.js?v=7.3.0"></script>


<script src="/js/next-boot.js?v=7.3.0"></script>




  




























  

  
    
      <script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', function() {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    
  

  

  


  
  <script src="/js/scrollspy.js?v=7.3.0"></script>
<script src="/js/post-details.js?v=7.3.0"></script>


</body>
</html>
